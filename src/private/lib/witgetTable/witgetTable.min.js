function setTd(t,e){e?.nodeType==Node.ELEMENT_NODE?t.append(e):t.innerHTML=e}class WitgetTable extends EventListener{dataTable=[];getDragger(t){let e=document.createElement("td");return e.innerHTML='<i class="bx bx-x"></i>',e.classList.add("dragger"),e.addEventListener("click",()=>{this.dataTable=this.dataTable.filter(e=>e!==t),this.tbody.removeChild(t.tr),this.emit("drop",t)}),e}constructor(t,e={drag:!0,drop:!0,columns:[]}){if("TABLE"!=t.nodeName)throw TypeError("El parametro table no es un elemento HTMLTableElement.");super(),this.table=t,this.config=e,t.classList.add("witgetTable");let a=t.querySelector("thead");this.thead=a||document.createElement("thead");let r=t.querySelector("tbody");this.tbody=r||document.createElement("tbody");let d=t.querySelector("tfoot");this.tfoot=d||document.createElement("tfoot"),t.append(this.thead,this.tbody,this.tfoot);let l=e?.columns,n=this.thead.querySelectorAll("th");if(this.columns=[...n].map((t,e)=>({tittle:l?.[e]?.tittle||t.textContent,width:l?.[e]?.width&&(t.style.width=l[e].width)||t.style.width||(t.style.width="auto"),textAlign:l?.[e]?.textAlign&&(t.style.textAlign=l[e].textAlign)||t.style.textAlign||(t.style.textAlign="center")})),!e.drop)return;let s=document.createElement("td");s.textContent="Cerrar",a.querySelector("tr").prepend(s)}newRow(t){let e=document.createElement("tr"),a={data:{},td:{},set:{},tr:e};if(this.config.drop){let r=this.getDragger(a);a.dragger=r,e.append(r)}return t?.constructor?.name=="Object"?(this.columns.forEach(({tittle:r,width:d,textAlign:l})=>{let n=document.createElement("td");n.style.width=d,n.style.textAlign=l;let s=(e=t[r]||"-")=>{setTd(n,e),a.data[r]=e};s(),a.set[r]=s,a.td[r]=n,e.append(n)}),a.data={...t}):t?.constructor?.name=="Array"?this.columns.forEach(({tittle:r,width:d,textAlign:l},n)=>{let s=document.createElement("td");s.style.width=d,s.style.textAlign=l;let o=(e=t[n]||"-")=>{setTd(s,e),a.data[r]=e};o(),a.set[r]=o,a.td[r]=s,e.append(s)}):alert(`Hay un error de tipo en la informaci\xf3n de la columna`),this.dataTable.push(a),this.tbody.append(e),this.config.drag&&this.#a(e,a),this.emit("add",a),a}#a(t=null,e){(t?[t]:this.tbody.querySelectorAll("tr:not(:first-of-type)")).forEach(t=>{t.draggable=!0,t.ondragstart=a=>{this.emit("drag",e),this.draggedRow=t,a.dataTransfer.dropEffect="move",a.dataTransfer.effectAllowed="move",a.dataTransfer.setData("text/html",t.innerHTML)},t.ondragover=t=>t.preventDefault(),t.ondrop=e=>{e.preventDefault(),this.draggedRow!==t&&(this.draggedRow.innerHTML=t.innerHTML,t.innerHTML=e.dataTransfer.getData("text/html"),this.#a(t),this.#a(this.draggedRow))},t.ondragenter=()=>t.classList.add("hover"),t.ondragleave=()=>t.classList.remove("hover"),t.ondragend=()=>{for(let t of this.tbody.querySelectorAll("tr:not(:first-of-type)"))t.classList.remove("hover")}})}}